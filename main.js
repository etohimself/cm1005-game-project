class Resources{constructor(_0x289987){this['gameRef']=_0x289987,this['loadedResources']=new Map(),this['tasks']=[];}['get'](_0xbc20a){return this['loadedResources']['get'](_0xbc20a);}['run'](){return this['loadResources'](this['gameRef']),this['gameRef']['objects']['forEach'](_0x1c28fc=>this['loadResources'](_0x1c28fc)),this['isReady']();}['loadResources'](_0x2079d4){if(_0x2079d4['loaded'])return;if(!_0x2079d4['resources']){_0x2079d4['loaded']=!![];if(_0x2079d4['onResourcesLoaded'])_0x2079d4['onResourcesLoaded']();}else{if(this['resourcesExist'](_0x2079d4['resources'])){this['recursivelyLoadResources'](_0x2079d4['resources']);if(!this['resourcesExist'](_0x2079d4['resources'])){_0x2079d4['loaded']=!![];if(_0x2079d4['onResourcesLoaded'])_0x2079d4['onResourcesLoaded']();}else _0x2079d4['loaded']=![];}else{_0x2079d4['loaded']=!![];if(_0x2079d4['onResourcesLoaded'])_0x2079d4['onResourcesLoaded']();}}}['recursivelyLoadResources'](_0x2dfee9){if(typeof _0x2dfee9=='string')return this['processPathString'](_0x2dfee9);else{if(Array['isArray'](_0x2dfee9))_0x2dfee9['forEach']((_0x33c037,_0x538d2c)=>{_0x2dfee9[_0x538d2c]=this['recursivelyLoadResources'](_0x33c037);});else{if(_0x2dfee9!=null&&typeof _0x2dfee9=='object'&&!(_0x2dfee9 instanceof p5['Image'])&&!(_0x2dfee9 instanceof p5['Font'])&&!(_0x2dfee9 instanceof Howl))for(const _0x145e61 in _0x2dfee9){_0x2dfee9[_0x145e61]=this['recursivelyLoadResources'](_0x2dfee9[_0x145e61]);}}}return _0x2dfee9;}['resourcesExist'](_0x5f34ce){let _0x1daa99=![];if(typeof _0x5f34ce=='string'){let _0x35cc6b=this['checkPathString'](_0x5f34ce);if(_0x35cc6b)_0x1daa99=!![];}else{if(Array['isArray'](_0x5f34ce))_0x5f34ce['forEach'](_0x52c994=>{let _0x37186c=this['resourcesExist'](_0x52c994);if(_0x37186c)_0x1daa99=!![];});else{if(_0x5f34ce!=null&&typeof _0x5f34ce=='object'&&!(_0x5f34ce instanceof p5['Image'])&&!(_0x5f34ce instanceof p5['Font'])&&!(_0x5f34ce instanceof Howl))for(const _0x5e0d14 in _0x5f34ce){let _0x178fe2=this['resourcesExist'](_0x5f34ce[_0x5e0d14]);if(_0x178fe2)_0x1daa99=!![];}}}return _0x1daa99;}['checkPathString'](_0x19dfed){if(_0x19dfed['slice'](-0x5)=='.json'||_0x19dfed['slice'](-0x4)=='.png'||_0x19dfed['slice'](-0x4)=='.ttf'||_0x19dfed['slice'](-0x4)=='.mp3')return!![];return![];}['processPathString'](_0x57d6f2){if(!this['checkPathString'](_0x57d6f2))return _0x57d6f2;if(this['loadedResources']['has'](_0x57d6f2))return this['get'](_0x57d6f2);else{if(this['tasks']['some'](_0x3834e5=>_0x3834e5['path']==_0x57d6f2))return _0x57d6f2;else{if(_0x57d6f2['slice'](-0x5)=='.json'){let _0x5d1d74=fetch(_0x57d6f2)['then'](_0x585df5=>_0x585df5['json']())['then'](_0x2c63d5=>{console['log']('Loaded\x20'+_0x57d6f2),this['loadedResources']['set'](_0x57d6f2,_0x2c63d5);})['catch'](_0x17abed=>{console['error']('Error\x20fetcing\x20json\x20file!\x20',_0x17abed);})['finally'](()=>{this['tasks']=this['tasks']['filter'](_0x2dce31=>_0x2dce31['promise']!=_0x5d1d74);});return this['tasks']['push']({'path':_0x57d6f2,'promise':_0x5d1d74}),_0x57d6f2;}else{if(_0x57d6f2['slice'](-0x4)=='.png'){let _0xb1d13c=loadImage(_0x57d6f2);return this['loadedResources']['set'](_0x57d6f2,_0xb1d13c),console['log']('Loaded\x20'+_0x57d6f2),_0xb1d13c;}else{if(_0x57d6f2['slice'](-0x4)=='.ttf'){let _0x3f5c85=loadFont(_0x57d6f2);return this['loadedResources']['set'](_0x57d6f2,_0x3f5c85),console['log']('Loaded\x20'+_0x57d6f2),_0x3f5c85;}else{if(_0x57d6f2['slice'](-0x4)==='.mp3'){let _0x10c24b=new Promise((_0x1c3fd6,_0x10afff)=>{let _0x22d6ca=new Howl({'src':[_0x57d6f2],'onload':()=>{_0x1c3fd6(_0x22d6ca);},'onloaderror':(_0x4a7544,_0x3f9f72)=>{_0x10afff(_0x3f9f72);}});});return this['tasks']['push']({'path':_0x57d6f2,'promise':_0x10c24b}),_0x10c24b['then'](_0x525c76=>{console['log']('Loaded\x20'+_0x57d6f2),this['loadedResources']['set'](_0x57d6f2,_0x525c76);})['finally'](()=>{this['tasks']=this['tasks']['filter'](_0x44760a=>_0x44760a['promise']!=_0x10c24b);}),_0x57d6f2;}}}}}}}['isReady'](){if(this['gameRef']['loaded']&&!this['gameRef']['objects']['some'](_0x5156ab=>!_0x5156ab['loaded'])&&!this['tasks']['length'])return!![];return![];}}class Game{constructor(_0x161e10){this['objects']=[],this['width']=0x1e0,this['height']=0xf0,this['skyColor']='#A7E9FF',this['mapLength']=0x0,this['player']=null,this['resources']={},this['loaded']=![],this['gameStarted']=!![],this['roundStarted']=!![],this['resourceManager']=new Resources(this),this['graphics']=new Graphics(this,_0x161e10),this['physics']=new Physics(this);}['run'](){if(!this['resourceManager']['run']())return;this['objects']['filter'](_0x4d25c4=>{let _0x5eae59=(_0x4d25c4['x']+this['graphics']['cameraX']*(_0x4d25c4?.['isBackground']==!![]?0.3:0x1))*this['graphics']['scaleRatio'],_0x336228=this['width']*this['graphics']['scaleRatio'];return _0x5eae59>_0x336228*-0.5&&_0x5eae59<_0x336228*1.5;})['forEach'](_0x55d46b=>_0x55d46b['run']&&_0x55d46b['run']()),this['graphics']['run'](),this['physics']['run'](),push(),scale(this['graphics']['scaleRatio']),this['customLogic'](),pop();}['customLogic'](){}['sky'](_0xa4b014){this['skyColor']=_0xa4b014;}['tile'](_0x1f80ee,_0xdc8c61,_0x2930b9){let _0x417df1=new _0x1f80ee(_0xdc8c61,_0x2930b9,this);this['objects']['push'](_0x417df1);if(_0x417df1['solid']&&_0x417df1['x']+_0x417df1['width']>this['mapLength'])this['mapLength']=_0x417df1['x']+_0x417df1['width'];return _0x417df1;}['character'](_0x35b9ff,_0x271d71,_0x272fcb){let _0x614db6=new _0x35b9ff(_0x271d71,_0x272fcb,this);return this['objects']['push'](_0x614db6),_0x614db6;}['remove'](_0x4eb883){this['objects']=this['objects']['filter'](_0x5095ba=>_0x5095ba!=_0x4eb883);}['restartGame'](){this['gameStarted']=!![],this['restartRound'](),this['onGameStart']();}['endGame'](){this['gameStarted']=![],this['onGameEnd']();}['restartRound'](){this['onRoundStart']();}['endRound'](){this['roundStarted']=![],this['onRoundEnd']();}['onRoundStart'](){this['objects']['forEach'](_0x23ba2d=>_0x23ba2d['onRoundStart']&&_0x23ba2d['onRoundStart']());}['onRoundEnd'](){this['objects']['forEach'](_0x516da0=>_0x516da0['onRoundEnd']&&_0x516da0['onRoundEnd']());}['onGameStart'](){this['objects']['forEach'](_0x2ed9da=>_0x2ed9da['onGameStart']&&_0x2ed9da['onGameStart']());}['onGameEnd'](){this['objects']['forEach'](_0x34200a=>_0x34200a['onGameEnd']&&_0x34200a['onGameEnd']());}}class Graphics{constructor(_0xfa1a6b,_0x241c09){this['gameRef']=_0xfa1a6b,this['scaleRatio']=_0x241c09,this['cameraX']=0x0,this['cameraY']=0x0,this['shakeStarted']=0x0,this['shakeStage']=0x0,this['shakeIntensity']=0x0,this['shakeDuration']=0x0,this['shakeTimer']=0x0,this['shakeOffsetX']=0x0,this['shakeOffsetY']=0x0,this['screenFadeStarted']=0x0,this['screenFadeRGB']=null,this['screenFadeTimer']=0x0,this['screenFadeDuration']=0x0,createCanvas(this['gameRef']['width']*this['scaleRatio'],this['gameRef']['height']*this['scaleRatio']),noSmooth();}['run'](){this['drawAllObjects'](),this['centerCamera'](),this['animateShake'](),this['animateFade'](),this['drawHealthBars'](),this['drawDamagePoints']();}['drawAllObjects'](){background(this['gameRef']['skyColor']),this['gameRef']['objects']['filter'](_0x14e57a=>{let _0x1e7d55=(_0x14e57a['x']+this['cameraX']*(_0x14e57a?.['isBackground']==!![]?0.3:0x1))*this['scaleRatio'],_0x3199c1=this['gameRef']['width']*this['scaleRatio'];return _0x1e7d55>_0x3199c1*-0.5&&_0x1e7d55<_0x3199c1*1.5;})['forEach'](_0xd25645=>this['drawObject'](_0xd25645));}['drawObject'](_0x2e1315){_0x2e1315['render']['forEach'](_0x49becc=>{if(_0x49becc['type']=='image'){if(_0x49becc['tint'])tint(_0x49becc['tint']);let _0x25b982=(_0x49becc['x']+this['cameraX']+this['shakeOffsetX'])*this['scaleRatio'],_0x20b904=(_0x49becc['y']+this['cameraY']+this['shakeOffsetY'])*this['scaleRatio'];_0x2e1315?.['isBackground']==!![]&&(_0x25b982=(_0x49becc['x']+this['cameraX']*0.3+this['shakeOffsetX'])*this['scaleRatio']);let _0x1c1a10=_0x49becc['width']*this['scaleRatio'],_0x556902=_0x49becc['height']*this['scaleRatio'];_0x49becc['mirrored']?(push(),translate(_0x25b982,_0x20b904),scale(-0x1,0x1),image(_0x49becc['image'],-_0x1c1a10,0x0,_0x1c1a10,_0x556902),pop()):image(_0x49becc['image'],_0x25b982,_0x20b904,_0x1c1a10,_0x556902),noTint();}});}['centerCamera'](){this['gameRef']['player']&&(this['cameraX']=this['gameRef']['width']/0x2-this['gameRef']['player']['x'],this['cameraX']=constrain(this['cameraX'],-this['gameRef']['mapLength']+this['gameRef']['width'],0x0));}['animateShake'](){if(!this['shakeStarted'])return;performance['now']()-this['shakeTimer']>=0xa&&(this['shakeOffsetX']=random(-this['shakeIntensity'],this['shakeIntensity'])*(0x1-this['shakeStage']/(this['shakeDuration']/0xa)),this['shakeOffsetY']=random(-this['shakeIntensity'],this['shakeIntensity'])*(0x1-this['shakeStage']/(this['shakeDuration']/0xa)),this['shakeStage']++,this['shakeTimer']=performance['now']()),this['shakeStage']>=this['shakeDuration']/0xa&&(this['shakeStarted']=0x0,this['shakeOffsetX']=0x0,this['shakeOffsetY']=0x0);}['animateFade'](){if(!this['screenFadeStarted'])return;if(!this['screenFadeRGB'])return;if(!this['screenFadeDuration'])return;let _0xac57cf=performance['now']()-this['screenFadeTimer'],_0x473fc2=constrain(this['screenFadeDuration']-_0xac57cf,0x0,this['screenFadeDuration']),_0x107416=_0x473fc2/this['screenFadeDuration']+0.001;_0x107416>0x0&&(fill(this['screenFadeRGB'][0x0],this['screenFadeRGB'][0x1],this['screenFadeRGB'][0x2],this['screenFadeRGB'][0x3]*_0x107416),rect(0x0,0x0,this['gameRef']['width']*this['scaleRatio'],this['gameRef']['height']*this['scaleRatio']));}['drawHealthBars'](){this['gameRef']['objects']['filter'](_0x265f51=>_0x265f51['isCharacter']==!![]&&_0x265f51!=this['gameRef']['player']&&_0x265f51['currentHP']>0x0&&performance['now']()-_0x265f51['attackedLast']<0xbb8)['forEach'](_0x470f3f=>{fill('black'),rect((_0x470f3f['x']+this['cameraX']+this['shakeOffsetX'])*this['scaleRatio'],(_0x470f3f['y']-_0x470f3f['height']*0.2+this['cameraY']+this['shakeOffsetY'])*this['scaleRatio'],_0x470f3f['width']*this['scaleRatio'],0x2*this['scaleRatio']);let _0x20f8d0=_0x470f3f['currentHP']/_0x470f3f['maxHP'];fill('#B4202A'),rect((_0x470f3f['x']+this['cameraX']+this['shakeOffsetX'])*this['scaleRatio'],(_0x470f3f['y']-_0x470f3f['height']*0.2+this['cameraY']+this['shakeOffsetY'])*this['scaleRatio'],_0x470f3f['width']*_0x20f8d0*this['scaleRatio'],0x2*this['scaleRatio']);});}['drawDamagePoints'](){this['gameRef']?.['resources']?.['uiFont']instanceof p5['Font']&&textFont(this['gameRef']?.['resources']?.['uiFont']),this['gameRef']['objects']['filter'](_0x25e488=>_0x25e488['isCharacter']==!![]&&performance['now']()-_0x25e488['attackedLast']<0x1f4)['forEach'](_0x5ae708=>{let _0x27b43d=''+Math['floor'](_0x5ae708['lastDamageReceived']),_0x38f520=this['gameRef']['player']['attackDamageMax']+this['gameRef']['player']['statPoints'][0x0],_0x4375ef=(0x1f4-(performance['now']()-_0x5ae708['attackedLast']))*0.024*Math['min'](Math['max'](0x1,_0x27b43d/_0x38f520),0x2)*this['scaleRatio'],_0x382bca=(_0x5ae708['x']+this['cameraX']+this['shakeOffsetX'])*this['scaleRatio'],_0x245a1b=(_0x5ae708['y']-_0x5ae708['height']*0.2-(performance['now']()-_0x5ae708['attackedLast'])*0.024*this['scaleRatio']+this['cameraY']+this['shakeOffsetY'])*this['scaleRatio'];fill(this['gameRef']['player']==_0x5ae708?'#B4202A':'white'),stroke('black'),textSize(_0x4375ef),strokeWeight(_0x4375ef/0xa),text(_0x27b43d,_0x382bca,_0x245a1b);});}['shakeScreen'](_0x53110c=0x1,_0x3592b1=0x64,_0x1877b=0x0){this['shakeStarted']=0x1,this['shakeIntensity']=_0x53110c*this['scaleRatio'],this['shakeDuration']=_0x3592b1,this['shakeStage']=0x0,this['shakeTimer']=performance['now']()-_0x3592b1/0xa+_0x1877b;}['screenFade'](_0x106a1d,_0x5d48a8=0x64,_0x442043=0x0){this['screenFadeStarted']=0x1,this['screenFadeRGB']=_0x106a1d,this['screenFadeTimer']=performance['now']()+_0x442043,this['screenFadeDuration']=_0x5d48a8;}}class Physics{constructor(_0x457d87){this['gameRef']=_0x457d87,this['gravityForce']=0.18,this['staticFrictionMultiplier']=0.1,this['kineticFrictionMultiplier']=0.5;}['run'](){this['gameRef']['objects']['filter'](_0x3967b6=>{let _0x46cee2=(_0x3967b6['x']+this['gameRef']['graphics']['cameraX']*(_0x3967b6?.['isBackground']==!![]?0.3:0x1))*this['gameRef']['graphics']['scaleRatio'],_0x92e466=this['gameRef']['width']*this['gameRef']['graphics']['scaleRatio'];return _0x46cee2>_0x92e466*-0.5&&_0x46cee2<_0x92e466*1.5;})['forEach'](_0xe4df54=>this['simulatePhysics'](_0xe4df54));}['simulatePhysics'](_0x3cf1d2){if(!_0x3cf1d2['physics'])return;!this['isObjectOnGround'](_0x3cf1d2)&&(_0x3cf1d2['velocityY']+=this['gravityForce']);if(_0x3cf1d2['velocityY']!=0x0&&_0x3cf1d2['y']<this['gameRef']['height']*0x2)this['move'](_0x3cf1d2,_0x3cf1d2['x'],_0x3cf1d2['y']+_0x3cf1d2['velocityY']);if(Math['abs'](_0x3cf1d2['velocityX'])>0.25)_0x3cf1d2['velocityX']*=this['kineticFrictionMultiplier'];else _0x3cf1d2['velocityX']*=this['staticFrictionMultiplier'];if(_0x3cf1d2['velocityX']!=0x0)this['move'](_0x3cf1d2,_0x3cf1d2['x']+_0x3cf1d2['velocityX'],_0x3cf1d2['y']);_0x3cf1d2['x']=constrain(_0x3cf1d2['x'],0x0,this['gameRef']['mapLength']-_0x3cf1d2['width']);}['move'](_0x3b831b,_0x50efb8,_0xdfd873){if(this['solidExistsInArea'](_0x50efb8,_0xdfd873,_0x3b831b['width'],_0x3b831b['height'],[_0x3b831b])){let _0x47366d=_0x50efb8-_0x3b831b['x'],_0x1c4116=_0xdfd873-_0x3b831b['y'],_0x292cd7=Math['max'](Math['abs'](_0x47366d),Math['abs'](_0x1c4116)),_0x41fade=_0x47366d/_0x292cd7,_0xd04632=_0x1c4116/_0x292cd7;for(let _0xad138b=_0x292cd7;_0xad138b>=0x1;_0xad138b--){if(!this['solidExistsInArea'](_0x3b831b['x']+_0x41fade*_0xad138b,_0x3b831b['y']+_0xd04632*_0xad138b,_0x3b831b['width'],_0x3b831b['height'],[_0x3b831b])){_0x3b831b['x']+=_0x41fade*_0xad138b,_0x3b831b['y']+=_0xd04632*_0xad138b;break;}}this['simulateCollision'](_0x3b831b,this['getSolidsInArea'](_0x50efb8,_0xdfd873,_0x3b831b['width'],_0x3b831b['height'],[_0x3b831b]));}else _0x3b831b['y']=_0xdfd873,_0x3b831b['x']=_0x50efb8;}['simulateCollision'](_0x40989e,_0x1d316d){let _0x1416c1=this['getObjectGroundLevel'](_0x40989e),_0x4383a9=this['getObjectDistanceToGround'](_0x40989e),_0x4b0473=this['getObjectDistanceToCeiling'](_0x40989e),_0x439a32=0x2*this['gameRef']['graphics']['scaleRatio'];if(_0x4383a9<_0x439a32&&_0x40989e['velocityY']>0x0){_0x40989e['velocityY']=0x0,_0x40989e['y']=_0x1416c1-_0x40989e['height'];if(_0x40989e['onLand'])_0x40989e['onLand'](_0x1d316d);}else{if(_0x4b0473<_0x439a32&&_0x40989e['velocityY']<0x1){_0x40989e['velocityY']=0x0;if(_0x40989e['onCeilingHit'])_0x40989e['onCeilingHit'](_0x1d316d);}else{_0x40989e['velocityX']=0x0;if(_0x40989e['onWallBump'])_0x40989e['onWallBump'](_0x1d316d);}}if(_0x40989e['onCollision'])_0x40989e['onCollision'](_0x1d316d);}['getSolidsInArea'](_0x457755,_0x3dd789,_0x536d81,_0x32e5c6,_0x4d01bd=[]){return this['gameRef']['objects']['filter'](_0x5d4358=>_0x5d4358['solid']==0x1&&!_0x4d01bd['includes'](_0x5d4358)&&!(_0x5d4358['x']>=_0x457755+_0x536d81-0x1||_0x5d4358['x']+_0x5d4358['width']-0x1<_0x457755||_0x5d4358['y']>=_0x3dd789+_0x32e5c6||_0x5d4358['y']+_0x5d4358['height']-0x1<_0x3dd789));}['solidExistsInArea'](_0x585acc,_0x4e5b50,_0x2fdc59,_0x1a4edc,_0x18d94d=[]){return this['getSolidsInArea'](_0x585acc,_0x4e5b50,_0x2fdc59,_0x1a4edc,_0x18d94d)['length']?!![]:![];}['isObjectOnGround'](_0x47ea09){return this['solidExistsInArea'](_0x47ea09['x'],_0x47ea09['y']+_0x47ea09['height'],_0x47ea09['width'],0x1);}['getObjectGroundLevel'](_0x4bc23b){let _0x1feeb5=this['getSolidsInArea'](_0x4bc23b['x'],_0x4bc23b['y']+_0x4bc23b['height'],_0x4bc23b['width'],0x1869f);if(!_0x1feeb5['length'])return 0x1869f;return _0x1feeb5['sort']((_0x41899e,_0x50211e)=>_0x41899e['y']-_0x50211e['y'])[0x0]['y'];}['getObjectCeilingLevel'](_0x3a1e73){let _0x3c452e=this['getSolidsInArea'](_0x3a1e73['x'],0x0,_0x3a1e73['width'],_0x3a1e73['y'],[_0x3a1e73]);if(!_0x3c452e['length'])return-0x1869f;let _0x2444cd=_0x3c452e['sort']((_0x3a8f32,_0x56e36c)=>_0x56e36c['y']-_0x3a8f32['y'])[0x0];return _0x2444cd['y']+_0x2444cd['height']-0x1;}['getObjectDistanceToCeiling'](_0x378d4c){let _0x12117c=this['getObjectCeilingLevel'](_0x378d4c);if(_0x12117c>=_0x378d4c['y'])return 0x0;return Math['abs'](_0x378d4c['y']-_0x12117c)-0x1;}['getObjectDistanceToGround'](_0x51f751){let _0x7feee5=this['getObjectGroundLevel'](_0x51f751),_0x9ee5e1=_0x51f751['y']+_0x51f751['height']-0x1;if(_0x7feee5<=_0x9ee5e1)return 0x0;return Math['abs'](_0x7feee5-_0x9ee5e1)-0x1;}}class Block{constructor(_0xd2f216,_0x3e4e56,_0x31be47){this['gameRef']=_0x31be47,this['x']=_0xd2f216,this['y']=_0x3e4e56,this['spawnX']=_0xd2f216,this['spawnY']=_0x3e4e56,this['width']=0x10,this['height']=0x10,this['velocityX']=0x0,this['velocityY']=0x0,this['physics']=![],this['solid']=![],this['visible']=!![],this['transparent']=![],this['customTint']=null,this['resources']={},this['loaded']=![],this['render']=[],this['isPlaying']=!![],this['isLooping']=!![],this['currentAnimation']=null,this['currentFrame']=0x0,this['animationMirrored']=![],this['lastFrameIncrementTime']=0x0;}['run'](){this['evaluateAnimation'](),this['progressAnimation'](),this['prepareRender'](),this['customLogic']();}['customLogic'](){}['evaluateAnimation'](){this['setAnimation']('default'),this['animationMirrored']=![];}['progressAnimation'](){if(!this['isPlaying'])return;if(!this['currentAnimation'])return;if(performance['now']()-this['lastFrameIncrementTime']>0x3e8/this['currentAnimation']['fps']){this['lastFrameIncrementTime']=performance['now'](),this['currentFrame']++;let _0x3a6d89=this['currentAnimation']['frames']['length']-0x1;this['currentFrame']>_0x3a6d89&&(this['currentFrame']=_0x3a6d89,this['onAnimationEnd'](this['currentAnimation']));}}['prepareRender'](){this['render']=[];if(!this['visible'])return;if(!this['currentAnimation'])return;let _0x5c1166={'type':'image','image':this['currentAnimation']['frames'][this['currentFrame']],'mirrored':this['animationMirrored'],'x':this['x']+this['currentAnimation']['offsetX'],'y':this['y']+this['currentAnimation']['offsetY'],'width':this['width']+this['currentAnimation']['offsetW'],'height':this['height']+this['currentAnimation']['offsetH']};if(this['transparent'])_0x5c1166['tint']=[0xff,0x64];if(this['customTint'])_0x5c1166['tint']=this['customTint'];this['render']['push'](_0x5c1166);}['getAnimation'](){return this['resources']['animations'][this['currentAnimationIndex']]['name'];}['setAnimation'](_0x4c35d8){if(!this['resources']||!this['resources']['animations']);let _0x1fddc3=this['resources']['animations']['find'](_0x41a37f=>_0x41a37f['name']==_0x4c35d8);if(!_0x1fddc3)return;this['currentAnimation']!=_0x1fddc3&&(this['currentAnimation']=_0x1fddc3,this['currentFrame']=0x0);}['onAnimationEnd'](){if(this['isLooping'])this['currentFrame']=0x0;}}class Character extends Block{constructor(_0x1afdb1,_0x4ca73c,_0x5d7127){super(_0x1afdb1,_0x4ca73c,_0x5d7127),this['resources']={},this['isCharacter']=!![],this['speed']=3.7,this['attackSpeed']=0x2,this['jumpStrength']=3.8,this['maxHP']=0x64,this['currentHP']=0x64,this['dead']=![],this['physics']=!![],this['solid']=!![],this['mayFall']=![],this['fallDirection']='',this['walking']=![],this['direction']='right',this['attackStarted']=![],this['skillStarted']=![],this['currentSkill']=null,this['jumpStarted']=![],this['hurtStarted']=![],this['walkLeftLast']=0x0,this['walkRightLast']=0x0,this['attackLast']=0x0,this['attackedLast']=-0x270f,this['lastDamageReceived']=0x0,this['regenerateHPLast']=-0x270f,this['regeneratePercentage']=0x1,this['keyDelayMs']=0x19;}['customLogic'](){super['customLogic'](),this['updateSkillCooldowns'](),this['checkCanyonFall'](),this['regenerateHealth'](),this['resetWalk']();}['evaluateAnimation'](){if(this['dead']==!![])this['setAnimation']('death'),this['isLooping']=![];else{if(this['attackStarted'])this['setAnimation']('attack');else{if(this['skillStarted'])this['setAnimation'](this['currentSkill']['animation']);else{if(this['jumpStarted'])this['setAnimation']('jump');else{if(this['hurtStarted'])this['setAnimation']('hurt');else this['walking']?this['setAnimation']('walk'):this['setAnimation']('idle');}}}}this['animationMirrored']=this['direction']=='left';}['updateSkillCooldowns'](){if(!this['resources']['skills'])return;this['resources']['skills']['forEach'](_0x34a16b=>{if(!_0x34a16b['hasOwnProperty']('isReady'))_0x34a16b['isReady']=!![];if(!_0x34a16b['hasOwnProperty']('lastUsed'))_0x34a16b['lastUsed']=performance['now']()-_0x34a16b['cooldown'];if(!_0x34a16b['hasOwnProperty']('remainingPercentage'))_0x34a16b['remainingPercentage']=0x0;let _0x455dcd=_0x34a16b['cooldown'],_0x2aa0af=_0x34a16b['lastUsed'],_0x3590a6=performance['now']()-_0x2aa0af,_0x209e15=constrain(_0x455dcd-_0x3590a6,0x0,_0x455dcd),_0x140d05=_0x209e15/_0x455dcd;_0x34a16b['remainingPercentage']=_0x140d05;if(_0x140d05==0x0)_0x34a16b['isReady']=!![];});}['checkCanyonFall'](){let _0x4e25c2=this['gameRef']['height']*1.5;if(this['y']>_0x4e25c2&&!this['dead'])this['kill']();let _0x2b3284=this['x']+(this['direction']=='right'?this['width']:-this['width']),_0x4eae63=this['y']+this['height'],_0x3b83e0=!this['gameRef']['physics']['solidExistsInArea'](_0x2b3284,_0x4eae63,this['width'],0x1869f,[this]);_0x3b83e0?(this['mayFall']=!![],this['fallDirection']=this['direction']):(this['mayFall']=![],this['fallDirection']='');}['resetWalk'](){let _0x3a8933=performance['now']()-this['walkLeftLast'],_0x3ff2b0=performance['now']()-this['walkRightLast'];_0x3a8933>this['keyDelayMs']&&_0x3ff2b0>this['keyDelayMs']&&(this['walking']=![]);}['walkRight'](){if(this['dead'])return;this['direction']='right',this['walking']=!![],this['walkRightLast']=performance['now']();if(this['velocityX']<this['speed'])this['velocityX']=this['speed'];}['walkLeft'](){if(this['dead'])return;this['direction']='left',this['walking']=!![],this['walkLeftLast']=performance['now']();if(this['velocityX']>-this['speed'])this['velocityX']=-this['speed'];}['jump'](){if(this['dead'])return;if(this['jumpStarted'])return;if(!this['gameRef']['physics']['isObjectOnGround'](this))return;let _0x2b5c76=this['gameRef']['graphics']['scaleRatio']*0x1;if(this['gameRef']['physics']['getObjectDistanceToCeiling'](this)<_0x2b5c76)return;this['jumpStarted']=!![],this['velocityY']=-this['jumpStrength'],this['y']+=0x1;}['attack'](){if(this['dead'])return;if(this['skillStarted'])return;if(this['attackStarted'])return;if(performance['now']()-this['attackLast']<0x3e8/this['attackSpeed'])return;let _0xce77af=this['resources']['animations']['find'](_0x3de426=>_0x3de426['name']=='attack'),_0x2b0b89=_0xce77af['frames']['length'],_0x34b4e3=_0x2b0b89*this['attackSpeed'];_0xce77af['fps']=_0x34b4e3,this['attackStarted']=!![],this['attackLast']=performance['now'](),this['onAttackStart']();}['useSkill'](_0x2c0333){if(this['dead'])return;if(this['attackStarted'])return;if(this['skillStarted'])return;let _0x17909c=this['resources']['skills']['find'](_0x39333a=>_0x39333a['name']==_0x2c0333);if(!_0x17909c)return;if(!_0x17909c['isReady'])return;this['currentSkill']=_0x17909c,this['skillStarted']=!![],_0x17909c['lastUsed']=performance['now'](),_0x17909c['isReady']=![],this['onSkillStart'](_0x17909c);}['kill'](_0x3e1e16){this['dead']=!![],this['currentHP']=0x0,this['solid']=![],this['onDeath'](_0x3e1e16);}['respawn'](){this['x']=this['spawnX'],this['y']=this['spawnY'],this['velocityX']=0x0,this['velocityY']=0x0,this['dead']=![],this['visible']=!![],this['solid']=!![],this['isLooping']=!![],this['currentHP']=this['maxHP'],this['attackStarted']=![],this['jumpStarted']=![],this['skillStarted']=![],this['hurtStarted']=![],this['transparent']=!![],setTimeout(function(){this['transparent']=![];}['bind'](this),0x3e8),this['resources']['skills']&&this['resources']['skills']['forEach'](_0x19b4d8=>{_0x19b4d8['lastUsed']=performance['now']()-_0x19b4d8['cooldown'],_0x19b4d8['isReady']=0x1,_0x19b4d8['remainingPercentage']=0x0;}),this['onSpawn']();}['regenerateHealth'](){if(!this['gameRef']['gameStarted'])return;if(this['dead'])return;if(this['currentHP']>=this['maxHP'])return;performance['now']()-this['attackedLast']>0x1388&&(performance['now']()-this['regenerateHPLast']>0x3e8&&(this['regenerateHPLast']=performance['now'](),this['currentHP']=min(this['maxHP'],this['currentHP']+this['maxHP']*(this['regeneratePercentage']/0x64))));}['onAnimationEnd'](_0x1d7f71){super['onAnimationEnd']();if(_0x1d7f71['name']=='attack')this['attackStarted']=![];else{if(this['currentSkill']&&_0x1d7f71['name']==this['currentSkill']['animation'])this['currentSkill']=null,this['skillStarted']=![];else _0x1d7f71['name']=='hurt'&&(this['hurtStarted']=![]);}}['onTakeDamage'](_0x615e2c,_0x1c46cf,_0x313f8a){this['attackedLast']=performance['now'](),this['lastDamageReceived']=_0x313f8a;}['onSpawn'](){}['onDeath'](_0x2fc057){}['onAttackStart'](){}['onSkillStart'](_0x3a0d81){}['onLand'](){this['jumpStarted']=![];}['onWallBump'](){}['onCeilingHit'](){}['onCollision'](){}['inflictDamage'](_0x27e2d2,_0x358fce){if(this['dead'])return;if(_0x27e2d2['dead'])return;let _0x254df7=this['currentHP'];this['currentHP']-=_0x358fce,this['customTint']=[0xff,0x64,0x64],setTimeout(function(){this['customTint']=null;}['bind'](this),0xc8);!this['jumpStarted']&&!this['attackStarted']&&!this['skillStarted']&&(this['direction']=_0x27e2d2['x']<this['x']?'left':'right',this['hurtStarted']=!![]);if(this['currentHP']<=0x0)this['kill'](_0x27e2d2);this['onTakeDamage'](_0x27e2d2,_0x254df7,_0x358fce);}['onGameStart'](){this['respawn']();}}class CustomGame extends Game{constructor(_0x4e2a7f){super(_0x4e2a7f),this['maxLives']=0x3,this['livesLeft']=this['maxLives'],this['coinsCollected']=0x0,this['clickAllowed']=!![],this['keyAllowed']=!![],this['characterScreenVisible']=![],this['helmetFlashAlpha']=0x0,this['helmetFlashStage']=0x0,this['tutorialScreenVisible']=!![],this['tutorialPage']=0x0,this['tutorialMaxPages']=0x3,this['finalBoss']=null,this['themeMusicPlaying']=![],this['resources']={'heartIcon':'assets/images/ui/heart.png','coinIcon':'assets/images/ui/coin.png','hudSprite':'assets/images/ui/hud.png','characterScreenUI':'assets/images/ui/characterScreen.png','tutorialScreenUI':'assets/images/ui/tutorialScreen.png','skeleton':'assets/images/ui/skeleton.png','plusButton':'assets/images/ui/plusButton.png','uiEmptySkill':'assets/images/skills/empty.png','uiFont':'assets/fonts/pixelify.ttf','customMap':'assets/data/customMap.json','themeMusic':'assets/sounds/theme.mp3'};}['customLogic'](){this['drawHud'](),this['characterScreen'](),this['drawGameOverScreen'](),this['drawWinScreen'](),this['tutorialScreen'](),this['resetClickAndKey'](),this['themeMusic']();}['onRoundStart'](){super['onRoundStart']();if(this['player']['mustSpawnAtStart']==!![])this['player']['mustSpawnAtStart']=![],this['player']['respawn']();else{let _0x266c50=this['player']['gameRef']['objects']['filter'](_0x45fbab=>_0x45fbab['type']=='Checkpoint'&&_0x45fbab['x']<=this['player']['x'])['sort']((_0x507971,_0x58e876)=>_0x58e876['x']-_0x507971['x']);_0x266c50['length']>0x0?(this['player']['respawn'](),this['player']['x']=_0x266c50[0x0]['x'],this['player']['y']=_0x266c50[0x0]['y']):this['player']['respawn']();}}['onGameEnd'](){super['onGameEnd'](),this['player']['mustSpawnAtStart']=!![];}['drawHud'](){this['drawHealthAndXpBar'](),this['drawSkillBar'](),this['drawLivesAndCoinCounters']();}['drawLivesAndCoinCounters'](){let _0x193380=0.0041666*this['height'],_0xa796cd=0xa*_0x193380;textFont(this['resources']['uiFont'],_0xa796cd),stroke('black'),strokeWeight(_0xa796cd/0xa),fill('white'),image(this['resources']['heartIcon'],0x5a*_0x193380,0x8*_0x193380,0x8*_0x193380,0x8*_0x193380),fill('#B4202A'),stroke('#541121'),text(this['livesLeft'],0x64*_0x193380,(0x5+_0xa796cd)*_0x193380),image(this['resources']['coinIcon'],0x72*_0x193380,0x8*_0x193380,0x8*_0x193380,0x8*_0x193380),fill('gold'),stroke('#544501'),text(this['coinsCollected'],0x7c*_0x193380,(0x5+_0xa796cd)*_0x193380);}['drawHealthAndXpBar'](){if(!this['player'])return;let _0x549a84=0.0041666*this['height'],_0x150831=0x8*_0x549a84;textFont(this['resources']['uiFont'],_0x150831),stroke('black'),strokeWeight(_0x150831/0xa),fill('white'),image(this['resources']['hudSprite'],0x8*_0x549a84,0x8*_0x549a84,0x48*_0x549a84,0x25*_0x549a84);let _0x5e0a03=this['player']['currentHP']/this['player']['maxHP'];fill('#B4202A'),rect(0x15*_0x549a84,0xc*_0x549a84,Math['floor'](0x38*_0x5e0a03)*_0x549a84,0x4*_0x549a84);let _0x3c1c49=this['player']['currentXP']/this['player']['maxXP'];fill('gold'),rect(0x15*_0x549a84,0x16*_0x549a84,Math['floor'](0x38*_0x3c1c49)*_0x549a84,0x4*_0x549a84),fill('white'),stroke('#544501'),text(this['player']['level']+'.\x20LvL',0x1d*_0x549a84,(0x21+_0x150831)*_0x549a84);if(this['player']['availableSkillPoints']>0x0||this['player']['availableStatPoints']>0x0){this['helmetFlashStage']==0x0?this['helmetFlashAlpha']++:this['helmetFlashAlpha']--;if(this['helmetFlashAlpha']>=0x19)this['helmetFlashStage']=0x1;else this['helmetFlashAlpha']<=0x0&&(this['helmetFlashStage']=0x0);noFill(),stroke([0xfb,0xf2,0x36,this['helmetFlashAlpha']*0x8]),strokeWeight(_0x549a84*0x3);let _0x47dba6=0x9*_0x549a84,_0x563961=0x21*_0x549a84,_0x4ff7f3=0xe*_0x549a84,_0x44444b=0xa*_0x549a84;rect(_0x47dba6,_0x563961,_0x4ff7f3,_0x44444b,_0x549a84);}}['drawSkillBar'](){if(!this['player'])return;let _0x38e0c6=this['height']*0.08,_0x285499=this['height']*0.08,_0x5ce62b=this['width']-_0x38e0c6,_0x176dac=this['height']*0.2;for(let _0x5ef4e1=0x0;_0x5ef4e1<0x5;_0x5ef4e1++){let _0x5812bc=_0x5ce62b,_0x2dcb93=_0x176dac+_0x5ef4e1*_0x285499,_0x36aedb=this['player']['resources']['skills']['length'];if(_0x5ef4e1<_0x36aedb){if(this['player']['skillPoints'][_0x5ef4e1]>0x0){let _0x1bf47a=this['player']['resources']['skills'][_0x5ef4e1];image(_0x1bf47a['skillIcon'],_0x5812bc,_0x2dcb93,_0x38e0c6,_0x285499),fill(0x0,0x0,0x0,0x96),noStroke(),rect(_0x5812bc,_0x2dcb93,_0x38e0c6,_0x285499*_0x1bf47a['remainingPercentage']);}else image(this['resources']['uiEmptySkill'],_0x5812bc,_0x2dcb93,_0x38e0c6,_0x285499);}else image(this['resources']['uiEmptySkill'],_0x5812bc,_0x2dcb93,_0x38e0c6,_0x285499);}}['drawGameOverScreen'](){if(!this['gameStarted']&&(this['finalBoss']==null||this['finalBoss']['currentHP']>0x0)){let _0x2c4ddf=0.0041666*this['height'],_0x5cfc10=0xd*_0x2c4ddf;fill([0x0,0x0,0x0,0x96]),rect(0x0,0x0,this['width'],this['height']),stroke('black'),strokeWeight(_0x5cfc10/0xa),fill('white');let _0x4f7218=this['coinsCollected']*0x5,_0x5a7fa1=(this['player']['level']-0x1)*0x7d,_0x50649d=_0x5a7fa1+_0x4f7218;textSize(_0x5cfc10*1.5),text('Game\x20over!',0xa6*_0x2c4ddf,0x50*_0x2c4ddf),textSize(_0x5cfc10*0x1),text('Total\x20Score\x20:\x20'+_0x50649d,0x85*_0x2c4ddf,0x6a*_0x2c4ddf),textSize(_0x5cfc10*0.7),text('Coins\x20Collected\x20:\x20'+_0x4f7218,0x85*_0x2c4ddf,0x78*_0x2c4ddf),text('Character\x20Level\x20:\x20'+_0x5a7fa1,0x85*_0x2c4ddf,0x85*_0x2c4ddf),text('Press\x20any\x20key\x20to\x20restart.',0x85*_0x2c4ddf,0xa0*_0x2c4ddf);if(keyIsPressed||mouseIsPressed)this['restartGame']();}}['drawWinScreen'](){if(!this['gameStarted']&&this['finalBoss']!=null&&this['finalBoss']['currentHP']<=0x0){let _0x58de3c=0.0041666*this['height'],_0x510d00=0xd*_0x58de3c;fill([0x0,0x0,0x0,0x96]),rect(0x0,0x0,this['width'],this['height']),stroke('black'),strokeWeight(_0x510d00/0xa),fill('white');let _0x475683=this['coinsCollected']*0x5,_0x38c051=(this['player']['level']-0x1)*0x7d,_0xb9c591=_0x38c051+_0x475683;textSize(_0x510d00*1.5),text('You\x20Won!',0xa6*_0x58de3c,0x50*_0x58de3c),textSize(_0x510d00*0x1),text('Total\x20Score\x20:\x20'+_0xb9c591,0x85*_0x58de3c,0x6a*_0x58de3c),textSize(_0x510d00*0.7),text('Coins\x20Collected\x20:\x20'+_0x475683,0x85*_0x58de3c,0x78*_0x58de3c),text('Character\x20Level\x20:\x20'+_0x38c051,0x85*_0x58de3c,0x85*_0x58de3c),text('Press\x20Enter\x20to\x20restart\x20game.',0x85*_0x58de3c,0xa0*_0x58de3c);if(keyIsDown(0xd))this['restartGame']();}}['characterScreen'](){this['handleCharacterButton'](),this['drawCharacterScreen'](),this['handleCharacterCloseButton'](),this['handleCharacterPlusButtons']();}['handleCharacterButton'](){if(this['characterScreenVisible'])return;if(!mouseIsPressed)return;if(!this['clickAllowed'])return;let _0x32985e=0.005555*this['height'],_0x43b554=0x6*_0x32985e,_0x12083e=0x18*_0x32985e,_0x20573c=0xc*_0x32985e,_0x46062c=0xa*_0x32985e;this['_isMouseOverArea'](_0x43b554,_0x12083e,_0x20573c,_0x46062c)&&(this['characterScreenVisible']=!![],this['clickAllowed']=![]);}['drawCharacterScreen'](){if(!this['characterScreenVisible'])return;let _0x29bfa5=0.005555*this['height'],_0x34d0a4=0x8*_0x29bfa5;textFont(this['resources']['uiFont'],_0x34d0a4),stroke('black'),strokeWeight(_0x34d0a4/0xa),fill('white');let _0x390ceb=0x28*_0x29bfa5,_0x248e07=0x1b*_0x29bfa5,_0x1046f7=0xf0*_0x29bfa5,_0x36130a=0x7e*_0x29bfa5;image(this['resources']['characterScreenUI'],_0x390ceb,_0x248e07,_0x1046f7,_0x36130a),fill('yellow'),stroke('#544501'),textSize(_0x34d0a4),text(this['player']['level']+'.\x20LvL',0x50*_0x29bfa5,(0x49+_0x34d0a4)*_0x29bfa5),fill('white'),stroke('#544501'),textSize(_0x34d0a4*0.75),text('Stat\x20points:\x20'+(this['player']['availableStatPoints']??0x0),0x43*_0x29bfa5,(0x55+_0x34d0a4*0.75)*_0x29bfa5),fill('white'),stroke('#544501'),textSize(_0x34d0a4*1.1),text(''+(this['player']['statPoints'][0x0]??0x0),0x56*_0x29bfa5,(0x5d+_0x34d0a4*1.1)*_0x29bfa5),text(''+(this['player']['statPoints'][0x1]??0x0),0x56*_0x29bfa5,(0x69+_0x34d0a4*1.1)*_0x29bfa5),text(''+(this['player']['statPoints'][0x2]??0x0),0x56*_0x29bfa5,(0x75+_0x34d0a4*1.1)*_0x29bfa5),fill('white'),stroke('#544501'),textSize(_0x34d0a4*0.75),text('Skill\x20points:\x20'+(this['player']['availableSkillPoints']??0x0),0x89*_0x29bfa5,(0x2f+_0x34d0a4*0.75)*_0x29bfa5),textSize(_0x34d0a4*0.75),text('Unleashes\x20a\x20fire\x20vortex.\x0a\x20[Dmg:'+(0x19+this['player']['statPoints'][0x0]*0x5+this['player']['skillPoints'][0x0]*0x1e)+'-'+(0x32+this['player']['statPoints'][0x0]*0x5+this['player']['skillPoints'][0x0]*0x1e)+']\x20-\x20[Shift]',0x9c*_0x29bfa5,(0x3a+_0x34d0a4*0.75)*_0x29bfa5),text('Gains\x20attack\x20speed.\x0a\x20[Duration:'+(0x7d0+this['player']['skillPoints'][0x1]*0x1f4)/0x3e8+'s]\x20-\x20[R]',0x9c*_0x29bfa5,(0x55+_0x34d0a4*0.75)*_0x29bfa5),text('Becomes\x20invisible.\x0a\x20[Duration:'+(0x7d0+this['player']['skillPoints'][0x2]*0x1f4)/0x3e8+'s]\x20[X]',0x9c*_0x29bfa5,(0x6e+_0x34d0a4*0.75)*_0x29bfa5);for(let _0x269ccf=0x0;_0x269ccf<0x3;_0x269ccf++){this['player']['skillPoints'][_0x269ccf]<0x1&&(fill([0x24,0x24,0x24,0xaf]),noStroke(),rect(0x8a*_0x29bfa5,(0x3a+_0x269ccf*26.5)*_0x29bfa5,0x5a*_0x29bfa5,0x18*_0x29bfa5));}if(this['player']['availableStatPoints']??0x0>0x0)for(let _0x347a27=0x0;_0x347a27<0x3;_0x347a27++){let _0x5e6d3d=0.275*this['width'],_0xeb084a=(0.529166+_0x347a27*0.07)*this['height'],_0x30d1fe=0.03125*this['width'],_0x5d0446=0.03125*this['width'];if(this['player']['statPoints'][_0x347a27]>=0x32)continue;image(this['resources']['plusButton'],_0x5e6d3d,_0xeb084a,_0x30d1fe,_0x5d0446);}if(this['player']['availableSkillPoints']??0x0>0x0)for(let _0xc098a9=0x0;_0xc098a9<0x3;_0xc098a9++){let _0x3ed5e7=0.6527*this['width'],_0x5147fe=(0.3333+_0xc098a9*0.15)*this['height'],_0x521050=0.06667*this['height'],_0x15acbd=0.06667*this['height'];if(this['player']['skillPoints'][_0xc098a9]>=0xa)continue;image(this['resources']['plusButton'],_0x3ed5e7,_0x5147fe,_0x521050,_0x15acbd);}}['handleCharacterCloseButton'](){if(!this['characterScreenVisible'])return;if(!mouseIsPressed)return;if(!this['clickAllowed'])return;let _0x5ab68d=0.005555*this['height'],_0x3db3ea=0x104*_0x5ab68d,_0x15f9f7=0x1f*_0x5ab68d,_0x325b68=0xc*_0x5ab68d,_0xd6e185=0xa*_0x5ab68d,_0x39170a=this['graphics']['scaleRatio'];this['_isMouseOverArea'](_0x3db3ea,_0x15f9f7,_0x325b68,_0xd6e185)&&(this['characterScreenVisible']=![],this['clickAllowed']=![]);}['handleCharacterPlusButtons'](){if(!this['characterScreenVisible'])return;if(!mouseIsPressed)return;if(!this['clickAllowed'])return;if(this['player']['availableStatPoints']??0x0>0x0)for(let _0x4471bb=0x0;_0x4471bb<0x3;_0x4471bb++){let _0x43ba76=0.275*this['width'],_0x211bc5=(0.529166+_0x4471bb*0.07)*this['height'],_0x4d5b86=0.03125*this['width'],_0x4e791b=0.03125*this['width'];this['_isMouseOverArea'](_0x43ba76,_0x211bc5,_0x4d5b86,_0x4e791b)&&(this['player']['availableStatPoints']--,this['player']['statPoints'][_0x4471bb]++,this['clickAllowed']=![],_0x4471bb==0x1&&(this['player']['currentHP']+=0x19,this['player']['maxHP']+=0x19),_0x4471bb==0x2&&(this['player']['regeneratePercentage']+=0x1));}if(this['player']['availableSkillPoints']??0x0>0x0)for(let _0x52bc41=0x0;_0x52bc41<0x3;_0x52bc41++){let _0x59eaef=0.6527*this['width'],_0x120ef5=(0.3333+_0x52bc41*0.15)*this['height'],_0x439065=0.06667*this['height'],_0x319edf=0.06667*this['height'];this['_isMouseOverArea'](_0x59eaef,_0x120ef5,_0x439065,_0x319edf)&&(this['player']['availableSkillPoints']--,this['player']['skillPoints'][_0x52bc41]++,this['clickAllowed']=![]);}}['tutorialScreen'](){this['handleHelpKey'](),this['drawTutorialScreen'](),this['handleTutorialForwardButton'](),this['handleTutorialBackButton'](),this['handleTutorialCloseButton']();}['handleHelpKey'](){keyIsDown(0x48)&&this['keyAllowed']&&(this['keyAllowed']=![],this['tutorialScreenVisible']=!this['tutorialScreenVisible']);}['drawTutorialScreen'](){if(!this['tutorialScreenVisible'])return;let _0x263d25=0.005555*this['height'],_0x354ce6=0x8*_0x263d25;textFont(this['resources']['uiFont'],_0x354ce6),stroke('black'),strokeWeight(_0x354ce6/0xa);let _0x253d23=0x28*_0x263d25,_0x4e598b=0x14*_0x263d25,_0x2c8d11=0x118*_0x263d25,_0x5e132b=0x92*_0x263d25;fill([0x0,0x0,0x0,0x96]),rect(0x0,0x0,0x1e0,0xf0),image(this['resources']['tutorialScreenUI'],_0x253d23,_0x4e598b,_0x2c8d11,_0x5e132b);if(this['tutorialPage']==0x0)fill('white'),textSize(_0x354ce6*1.5),text('Tutorial',0x9e*_0x263d25,0x2a*_0x263d25),textSize(_0x354ce6*0.85),text('Welcome\x20to\x20Knights\x20&\x20Skeletons\x202D\x20platformer\x20game.\x0a\x20\x20You\x20can\x20move\x20your\x20knight\x20with\x20A,D\x20and\x20Space\x20keys.\x20You\x20can\x0a\x20\x20attack\x20with\x20Enter\x20key.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',0x64*_0x263d25,0x36*_0x263d25),fill(''),noStroke(),fill('white'),textSize(_0x354ce6*0.6),text('Move\x20Left',0x64*_0x263d25,0x5f*_0x263d25),text('Move\x20Right',0xaa*_0x263d25,0x5f*_0x263d25),text('Jump',0x8c*_0x263d25,0x7d*_0x263d25),text('Attack',0xf0*_0x263d25,0x69*_0x263d25),rect(0x82*_0x263d25,0x55*_0x263d25,0x10*_0x263d25,0x10*_0x263d25,_0x263d25),rect(0x96*_0x263d25,0x55*_0x263d25,0x10*_0x263d25,0x10*_0x263d25,_0x263d25),rect(0x82*_0x263d25,0x69*_0x263d25,0x30*_0x263d25,0xc*_0x263d25,_0x263d25),rect(0xc8*_0x263d25,0x66*_0x263d25,0x24*_0x263d25,0xf*_0x263d25,_0x263d25),rect(0xda*_0x263d25,0x5d*_0x263d25,0x12*_0x263d25,0x18*_0x263d25,_0x263d25),fill('black'),textSize(_0x354ce6*1.5),text('A',0x87*_0x263d25,0x60*_0x263d25),text('D',0x9b*_0x263d25,0x60*_0x263d25),textSize(_0x354ce6*1.1),text('Space',0x87*_0x263d25,0x71*_0x263d25),text('Enter',0xcd*_0x263d25,0x6f*_0x263d25);else{if(this['tutorialPage']==0x1)fill('white'),textSize(_0x354ce6*1.5),text('Special\x20Abilities',0x84*_0x263d25,0x2a*_0x263d25),textSize(_0x354ce6*0.85),text('You\x20will\x20gain\x201\x20skill\x20point\x20for\x20each\x20new\x20level.You\x20can\x20\x0a\x20\x20upgrade\x20and\x20unlock\x20skills\x20by\x20clicking\x20helmet\x20icon.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',0x6e*_0x263d25,0x36*_0x263d25),image(this['player']['resources']['skills'][0x0]['skillIcon'],0x6e*_0x263d25,0x46*_0x263d25,0x14,0x14),image(this['player']['resources']['skills'][0x1]['skillIcon'],0x6e*_0x263d25,0x5a*_0x263d25,0x14,0x14),image(this['player']['resources']['skills'][0x2]['skillIcon'],0x6e*_0x263d25,0x6e*_0x263d25,0x14,0x14),textSize(_0x354ce6*0.7),fill('white'),text('Damages\x20skeletons\x20nearby.\x20Damage\x20depends\x20on\x0a\x20\x20skill\x20level\x20and\x20ATK\x20stat.',0x80*_0x263d25,0x4b*_0x263d25),text('Gains\x20attack\x20and\x20movement\x20speed\x20temporarily.\x0a\x20\x20Duration\x20depends\x20on\x20skill\x20level.',0x80*_0x263d25,0x5f*_0x263d25),text('Becomes\x20invisible\x20temporarily.\x20Duration\x20depends\x20on\x0a\x20\x20skill\x20level.',0x80*_0x263d25,0x73*_0x263d25),textSize(_0x354ce6),text('Shift',0x55*_0x263d25,0x50*_0x263d25),text('R',0x64*_0x263d25,0x64*_0x263d25),text('X',0x64*_0x263d25,0x78*_0x263d25);else{if(this['tutorialPage']==0x2)fill('white'),textSize(_0x354ce6*1.5),text('Character\x20Stats',0x78*_0x263d25,0x2a*_0x263d25),textSize(_0x354ce6*0.85),text('You\x20will\x20gain\x202\x20stat\x20points\x20for\x20each\x20new\x20level.\x0a\x20\x20You\x20can\x20use\x20stat\x20points\x20by\x20clicking\x20helmet\x20icon.',0x6e*_0x263d25,0x36*_0x263d25),textSize(_0x354ce6*1.5),fill('#66A0FF'),text('ATK',0x64*_0x263d25,0x55*_0x263d25),fill('#F45F6C'),text('DEF',0x64*_0x263d25,0x69*_0x263d25),fill('#389C73'),text('INT',0x64*_0x263d25,0x7d*_0x263d25),textSize(_0x354ce6*0.7),fill('white'),text('Strengthens\x20basic\x20attacks\x20and\x20firestorm\x20skill.',0x7d*_0x263d25,0x51*_0x263d25),text('Increases\x20armour\x20and\x20health\x20points.',0x7d*_0x263d25,0x65*_0x263d25),text('Increases\x20health\x20regeneration\x20and\x20critical\x20hit\x20chance\x20%.',0x7d*_0x263d25,0x79*_0x263d25);else this['tutorialPage']==0x3&&(fill('white'),textSize(_0x354ce6*1.5),text('Objective',0x96*_0x263d25,0x2a*_0x263d25),textSize(_0x354ce6*0.85),text('As\x20a\x20royal\x20knight\x20of\x20the\x20kingdom,\x20your\x20mission\x20is\x20to\x0a\x20\x20slay\x20the\x20skeleton\x20king.\x20Make\x20sure\x20to\x20farm\x20XP\x20points,\x20upgrade\x0a\x20\x20skills\x20and\x20stats\x20before\x20you\x20face\x20him\x20at\x20the\x20end\x20of\x20the\x20map.',0x50*_0x263d25,0x36*_0x263d25),image(this['resources']['skeleton'],0x91*_0x263d25,0x69*_0x263d25),image(this['resources']['skeleton'],0xa0*_0x263d25,0x55*_0x263d25,0x36,0x36),image(this['resources']['skeleton'],0xc3*_0x263d25,0x69*_0x263d25));}}fill('white'),textSize(_0x354ce6*0.5),text('Page\x20'+(this['tutorialPage']+0x1)+'/'+(this['tutorialMaxPages']+0x1),0x11c*_0x263d25,0x94*_0x263d25),textSize(_0x354ce6*0.8),fill('white'),text('Press\x20H\x20to\x20display\x20tutorial\x20again.',0x82*_0x263d25,0x94*_0x263d25);}['handleTutorialBackButton'](){if(!this['tutorialScreenVisible'])return;if(!mouseIsPressed)return;if(!this['clickAllowed'])return;let _0xfe85c0=0.005555*this['height'],_0xbaa429=0xf3*_0xfe85c0,_0x3e9069=0x98*_0xfe85c0,_0x3d9016=0x1c*_0xfe85c0,_0x3be980=0xa*_0xfe85c0;this['_isMouseOverArea'](_0xbaa429,_0x3e9069,_0x3d9016,_0x3be980)&&(this['tutorialPage']=max(this['tutorialPage']-0x1,0x0),this['clickAllowed']=![]);}['handleTutorialForwardButton'](){if(!this['tutorialScreenVisible'])return;if(!mouseIsPressed)return;if(!this['clickAllowed'])return;let _0x3b5fc9=0.005555*this['height'],_0x31797c=0x111*_0x3b5fc9,_0x4e1714=0x98*_0x3b5fc9,_0x6f82fb=0x1c*_0x3b5fc9,_0x4afc32=0xa*_0x3b5fc9;this['_isMouseOverArea'](_0x31797c,_0x4e1714,_0x6f82fb,_0x4afc32)&&(this['tutorialPage']=min(this['tutorialPage']+0x1,this['tutorialMaxPages']),this['clickAllowed']=![]);}['handleTutorialCloseButton'](){if(!this['tutorialScreenVisible'])return;if(!mouseIsPressed)return;if(!this['clickAllowed'])return;let _0x5c5e91=0.005555*this['height'],_0x4e9838=0x12d*_0x5c5e91,_0x43e1e7=0x15*_0x5c5e91,_0x1160f1=0xc*_0x5c5e91,_0x14194c=0xd*_0x5c5e91,_0x1cd31b=this['graphics']['scaleRatio'];mouseX>=_0x4e9838*_0x1cd31b&&mouseX<=(_0x4e9838+_0x1160f1)*_0x1cd31b&&mouseY>=_0x43e1e7*_0x1cd31b&&mouseY<=(_0x43e1e7+_0x14194c)*_0x1cd31b&&(this['tutorialScreenVisible']=![],this['clickAllowed']=![]);}['resetClickAndKey'](){!this['clickAllowed']&&!mouseIsPressed&&(this['clickAllowed']=!![]),!this['keyAllowed']&&!keyIsPressed&&(this['keyAllowed']=!![]);}['onGameStart'](){super['onGameStart'](),this['livesLeft']=this['maxLives'],this['coinsCollected']=0x0,this['objects']['forEach'](_0x3cd57f=>_0x3cd57f['respawn']&&_0x3cd57f['respawn']()),this['resources']['themeMusic']['stop'](),this['resources']['themeMusic']['volume'](0.5),this['resources']['themeMusic']['loop'](!![]),this['resources']['themeMusic']['play']();}['_isMouseOverArea'](_0x413342,_0x3a18a8,_0x4e5a23,_0x37989b){if(mouseX>=_0x413342*this['graphics']['scaleRatio']&&mouseX<=(_0x413342+_0x4e5a23)*this['graphics']['scaleRatio']&&mouseY>=_0x3a18a8*this['graphics']['scaleRatio']&&mouseY<=(_0x3a18a8+_0x37989b)*this['graphics']['scaleRatio'])return!![];return![];}['themeMusic'](){!this['themeMusicPlaying']&&(this['resources']['themeMusic']['volume'](0.2),this['resources']['themeMusic']['loop'](!![]),this['resources']['themeMusic']['play'](),this['themeMusicPlaying']=!![]);}}class Cloud extends Block{constructor(_0x3055d6,_0x2dccc1,_0x413dd9){super(_0x3055d6,_0x2dccc1,_0x413dd9),this['type']='Cloud',this['width']=0x30,this['height']=0x18,this['isBackground']=!![],this['resources']={'animations':'assets/data/cloud.json'};}}class Mountain extends Block{constructor(_0xb57573,_0x30c909,_0xe4e14b){super(_0xb57573,_0x30c909,_0xe4e14b),this['resources']={'animations':'assets/data/mountain.json'},this['type']='Mountain',this['height']=0x60,this['width']=0x60,this['isBackground']=!![];}}class Ground extends Block{constructor(_0x4b04be,_0x3749f4,_0x430d5a,_0x1ff0fd,_0x12389f){super(_0x4b04be,_0x3749f4,_0x430d5a,_0x1ff0fd,_0x12389f),this['resources']={'animations':'assets/data/ground.json'},this['type']='Ground',this['width']=0x10,this['height']=0x10,this['solid']=0x1;}}class Stone extends Block{constructor(_0x319d56,_0x1728d5,_0x3a6cf6,_0xd055e0,_0x2e3354){super(_0x319d56,_0x1728d5,_0x3a6cf6,_0xd055e0,_0x2e3354),this['resources']={'animations':'assets/data/stone.json'},this['type']='Stone',this['width']=0x10,this['height']=0x10,this['solid']=0x1;}}class CanyonLeft extends Block{constructor(_0x141410,_0x5bf98c,_0x24c1aa){super(_0x141410,_0x5bf98c,_0x24c1aa),this['resources']={'animations':'assets/data/canyonLeft.json'},this['type']='Ground',this['width']=0x10,this['height']=0x10,this['solid']=0x1;}}class CanyonRight extends Block{constructor(_0x16e691,_0x2e1cd1,_0x196cbf){super(_0x16e691,_0x2e1cd1,_0x196cbf),this['resources']={'animations':'assets/data/canyonRight.json'},this['type']='Ground',this['width']=0x10,this['height']=0x10,this['solid']=0x1;}}class Tree extends Block{constructor(_0x4877ae,_0x280bfc,_0x265541){super(_0x4877ae,_0x280bfc,_0x265541),this['resources']={'animations':'assets/data/tree.json'},this['type']='Tree',this['width']=0x30,this['height']=0x30,this['solid']=![];}}class Coin extends Block{constructor(_0x149b9a,_0x15708a,_0x179c49){super(_0x149b9a,_0x15708a,_0x179c49),this['resources']={'animations':'assets/data/coin.json','collectSound':'assets/sounds/coin.mp3'},this['type']='Coin',this['width']=0x8,this['height']=0x8,this['isCollectible']=!![],this['physics']=!![],this['solid']=![],this['collected']=![],this['visible']=!![];}['customLogic'](){super['customLogic']();if(this['collected'])return;if(!this['gameRef']['player'])return;!(this['gameRef']['player']['x']+this['gameRef']['player']['width']<this['x']||this['gameRef']['player']['x']>this['x']+this['width']||this['gameRef']['player']['y']+this['gameRef']['player']['height']<this['y']||this['gameRef']['player']['y']>this['y']+this['height'])&&(this['collected']=!![],this['gameRef']['coinsCollected']++,this['resources']['collectSound']['volume'](0.7),this['resources']['collectSound']['play'](),this['transparent']=!![],this['y']=this['gameRef']['player']['y']-this['height'],this['velocityY']=-0x2,setTimeout(()=>{this['visible']=![];},0x12c));if(this['y']>this['gameRef']['height']*0x2)this['gameRef']['remove'](this);}['respawn'](){this['collected']=![],this['visible']=!![],this['transparent']=![],this['x']=this['spawnX'],this['y']=this['spawnY'],this['velocityX']=0x0,this['velocityY']=0x0;}['onGameStart'](){this['respawn']();}}class Box extends Block{constructor(_0x35f671,_0x273044,_0x11b334){super(_0x35f671,_0x273044,_0x11b334),this['resources']={'animations':'assets/data/box.json'},this['type']='Box',this['width']=0xd,this['height']=0xd,this['solid']=0x1;}}class LevelupFX extends Block{constructor(_0x37b15b,_0x304191,_0x1eaa03){super(_0x37b15b,_0x304191,_0x1eaa03),this['type']='FX',this['width']=0x14,this['height']=0x24,this['solid']=![],this['physics']=![],this['visible']=![],this['resources']={'animations':'assets/data/levelupfx.json'};}['customLogic'](){super['customLogic'](),this['x']=this['gameRef']['player']['x'],this['y']=this['gameRef']['player']['y'];}['onAnimationEnd'](){super['onAnimationEnd'](),this['visible']=![];}}class Checkpoint extends Block{constructor(_0x6ab933,_0x56b891,_0x484808,_0x308748,_0x468946){super(_0x6ab933,_0x56b891,_0x484808,_0x308748,_0x468946),this['resources']={'animations':'assets/data/ground.json'},this['type']='Checkpoint',this['width']=0x10,this['height']=0x10,this['solid']=0x0,this['visible']=0x0;}}class Knight extends Character{constructor(_0x58c003,_0x17ae2e,_0x862f7){super(_0x58c003,_0x17ae2e,_0x862f7),this['resources']={'animations':'assets/data/knight.json','sounds':{'walk':'assets/sounds/knight/walk.mp3','attack':'assets/sounds/knight/slash.mp3','death':'assets/sounds/knight/death.mp3','levelup':'assets/sounds/knight/levelup.mp3'},'skills':'assets/data/knightSkills.json'},this['gameRef']['player']=this,this['type']='Knight',this['width']=0xa,this['height']=0xf,this['maxHP']=0x64,this['attackDamageMin']=0xa,this['attackDamageMax']=0x14,this['attackRange']=0xa,this['speed']=2.5,this['attackSpeed']=0x3,this['jumpStrength']=3.8,this['regeneratePercentage']=0x0,this['level']=0x1,this['currentXP']=0x0,this['maxXP']=0x64,this['levelupFX']=null,this['availableStatPoints']=0x5,this['availableSkillPoints']=0x1,this['statPoints']=[0x0,0x0,0x0],this['skillPoints']=[0x0,0x0,0x0],this['isCloaked']=![],this['cloakTimer']=null,this['rageTimer']=null,this['canUseSkill']=!![],this['mustSpawnAtStart']=![],this['leftKeyCode']=0x41,this['rightKeyCode']=0x44,this['jumpKeyCode']=0x20,this['attackKeyCode']=0xd,this['skillKeyCodes']=[0x10,0x52,0x58],this['lastWalk']=0x0;}['customLogic'](){super['customLogic'](),this['keyboardControls'](),this['updateCloak']();}['keyboardControls'](){if(!this['gameRef']['gameStarted'])return;if(this['dead'])return;if(keyIsDown(this['leftKeyCode']))this['walkLeft'](),this['playWalkSound']();else keyIsDown(this['rightKeyCode'])&&(this['walkRight'](),this['playWalkSound']());keyIsDown(this['jumpKeyCode'])&&this['jump']();keyIsDown(this['attackKeyCode'])&&this['attack']();if(keyIsDown(this['skillKeyCodes'][0x0])){if(this['skillPoints'][0x0]<0x1)return;this['useSkill']('Firestorm');}if(keyIsDown(this['skillKeyCodes'][0x1])){if(this['skillPoints'][0x1]<0x1)return;this['useSkill']('Rage');}if(keyIsDown(this['skillKeyCodes'][0x2])){if(this['skillPoints'][0x2]<0x1)return;this['useSkill']('Cloak');}}['onDeath'](_0x13cfea){super['onDeath'](_0x13cfea),this['resources']['sounds']['death']['volume'](0.6),this['resources']['sounds']['death']['rate'](1.4),this['resources']['sounds']['death']['play'](),this['currentXP']*=0.5,setTimeout(()=>{this['gameRef']['livesLeft']>0x0?(this['gameRef']['livesLeft']--,this['gameRef']['restartRound']()):this['gameRef']['endGame']();},0x7d0);}['onTakeDamage'](_0x55f28e,_0x176e92,_0x2a706c){let _0x52a5bd=_0x2a706c;_0x2a706c-=this['statPoints'][0x1],_0x2a706c=max(_0x2a706c,0x1),this['currentHP']+=_0x52a5bd-_0x2a706c,super['onTakeDamage'](_0x55f28e,_0x176e92,_0x2a706c),this['currentHP']<=0x0?this['gameRef']['graphics']['screenFade']([0xc8,0x64,0x64,0xff],0x7d0,0x0):this['gameRef']['graphics']['screenFade']([0xc8,0x64,0x64,0x96],0xc8,0x0);}['onAttackStart'](){super['onAttackStart'](),this['gameRef']['graphics']['shakeScreen'](0x1,0x64,0x64),this['resources']['sounds']['attack']['stop'](),this['resources']['sounds']['attack']['rate'](random(0.8,1.1)),this['resources']['sounds']['attack']['play'](),setTimeout(()=>{let _0x20f76f=this['gameRef']['objects']['filter'](_0x56ef88=>_0x56ef88['type']=='Skeleton'&&!_0x56ef88['dead'])['map'](_0x52e6ac=>{return{'obj':_0x52e6ac,'distance':dist(_0x52e6ac['x']+_0x52e6ac['width']/0x2,_0x52e6ac['y']+_0x52e6ac['height']/0x2,this['x']+this['width']/0x2,this['y']+this['height']/0x2)/this['gameRef']['graphics']['scaleRatio']};}),_0x2bae95=_0x20f76f['filter'](_0xf01e52=>_0xf01e52['distance']<this['attackRange']&&(this['direction']=='right'&&_0xf01e52['obj']['x']>this['x']||this['direction']=='left'&&_0xf01e52['obj']['x']<this['x'])),_0x542481=random(0x0,0x64)<this['statPoints'][0x2]*0x2?0x5:0x1;_0x2bae95['forEach'](_0x368704=>{_0x368704['obj']['inflictDamage'](this,Math['floor'](random((this['attackDamageMin']+this['statPoints'][0x0]*0x2)*_0x542481,(this['attackDamageMax']+this['statPoints'][0x0]*0x2)*_0x542481)));});},0x64);}['onSkillStart'](_0x2cdcd8){super['onSkillStart'](),this['canUseSkill']=![],_0x2cdcd8['name']=='Firestorm'&&(this['gameRef']['graphics']['shakeScreen'](0x1,0x28a,0x1f4),setTimeout(()=>_0x2cdcd8['soundEffect']['play'](),0x12c),setTimeout(()=>{let _0x41537d=this['gameRef']['objects']['filter'](_0x3dd5b2=>_0x3dd5b2['type']=='Skeleton'&&!_0x3dd5b2['dead'])['map'](_0x3f3d83=>{return{'obj':_0x3f3d83,'distance':dist(_0x3f3d83['x']+_0x3f3d83['width']/0x2,_0x3f3d83['y']+_0x3f3d83['height']/0x2,this['x']+this['width']/0x2,this['y']+this['height']/0x2)/this['gameRef']['graphics']['scaleRatio']};});setTimeout(()=>{this['canUseSkill']=!![];},0x5dc);let _0x42c5c4=_0x41537d['filter'](_0x2ace08=>_0x2ace08['distance']<_0x2cdcd8['range']);_0x42c5c4['forEach'](_0x34f374=>{_0x34f374['obj']['inflictDamage'](this,Math['floor'](random(0x19+this['statPoints'][0x0]*0x5+this['skillPoints'][0x0]*0x1e,0x32+this['statPoints'][0x0]*0x5+this['skillPoints'][0x0]*0x1e)));});},0x1f4)),_0x2cdcd8['name']=='Cloak'&&(_0x2cdcd8['soundEffect']['play'](),this['isCloaked']=!![],this['cloakTimer']=setTimeout(()=>{this['isCloaked']=![];},0x7d0+0x1f4*this['skillPoints'][0x2])),_0x2cdcd8['name']=='Rage'&&(_0x2cdcd8['soundEffect']['play'](),this['attackSpeed']=0x6,this['speed']=0x3,this['rageTimer']=setTimeout(()=>{this['attackSpeed']=0x3,this['speed']=2.5;},0x7d0+0x1f4*this['skillPoints'][0x1]));}['playWalkSound'](){if(!this['gameRef']['physics']['isObjectOnGround'](this))return;performance['now']()-this['lastWalk']>0xfa&&(this['lastWalk']=performance['now'](),this['resources']['sounds']['walk']['stop'](),this['resources']['sounds']['walk']['volume'](0.5),this['resources']['sounds']['walk']['play']());}['giveXP'](_0x80a3d2){this['currentXP']+=_0x80a3d2,this['currentXP']>this['maxXP']&&(this['currentXP']=0x0,this['maxXP']*=1.5,this['level']++,this['levelupFX']!=null&&this['levelupFX']['type']=='FX'&&(this['levelupFX']['currentFrame']=0x0,this['levelupFX']['visible']=0x1),this['resources']['sounds']['levelup']['volume'](0.8),this['resources']['sounds']['levelup']['play'](),this['currentHP']=this['maxHP'],this['availableSkillPoints']++,this['availableStatPoints']+=0x2);}['updateCloak'](){if(this['isCloaked'])this['customTint']=[0xc8,0xc8,0xff,0x32];else(this['customTint']=[0xc8,0xc8,0xff,0x32])&&(this['customTint']=null);}['onSpawn'](){super['onSpawn']();if(this['cloakTimer'])clearTimeout(this['cloakTimer']);if(this['rageTimer'])clearTimeout(this['rageTimer']);this['attackSpeed']=0x3,this['speed']=2.5,this['customTint']=null;}['onGameStart'](){super['onGameStart'](),this['maxHP']=0x64,this['currentHP']=0x64,this['speed']=2.5,this['attackSpeed']=0x3,this['regeneratePercentage']=0x0,this['level']=0x1,this['currentXP']=0x0,this['maxXP']=0x64,this['availableStatPoints']=0x5,this['availableSkillPoints']=0x1,this['statPoints']=[0x0,0x0,0x0],this['skillPoints']=[0x0,0x0,0x0],this['isCloaked']=![],this['cloakTimer']=null,this['rageTimer']=null,this['canUseSkill']=!![],this['mustSpawnAtStart']=![];}}class Skeleton extends Character{constructor(_0xa91a88,_0x2673ee,_0x236f37){super(_0xa91a88,_0x2673ee,_0x236f37),this['resources']={'animations':'assets/data/skeleton.json','sounds':{'attack':'assets/sounds/skeleton/attack.mp3'}},this['type']='Skeleton',this['speed']=2.5,this['attackSpeed']=0x2,this['jumpStrength']=3.8,this['width']=0x14,this['height']=0x14,this['maxHP']=0x64,this['attackDamageMin']=0x5,this['attackDamageMax']=0x14,this['attackRange']=0xa,this['regeneratePercentage']=0x5,this['solid']=0x1,this['followRange']=0x28,this['jumpDelayMs']=0x3e8,this['targetForgetTime']=0x3e8,this['roamDelay']=0x3e8,this['lastJump']=0x0,this['lastRoam']=0x0,this['targetLastSeen']=0x0,this['waypoint']=null;}['customLogic'](){super['customLogic'](),this['npcAI']();}['npcAI'](){if(!this['gameRef']['gameStarted'])return;if(this['dead'])return;this['findNearbyPlayers'](),this['roamRandomly'](),this['goToWaypoint'](),this['attackNearbyEnemies']();}['findNearbyPlayers'](){let _0x4ef801=this['getPlayersWithinRange'](this['followRange']);if(_0x4ef801['length']){let _0x46e5e1=_0x4ef801[0x0];this['setWaypoint'](_0x46e5e1['obj']['x']+_0x46e5e1['obj']['width']/0x2,_0x46e5e1['obj']['y']+_0x46e5e1['obj']['height']/0x2);}}['roamRandomly'](){if(this['dead'])return;if(this['waypoint'])return;if(performance['now']()-this['lastRoam']<this['roamDelay'])return;this['lastRoam']=performance['now']();for(let _0x1f5694=0x0;_0x1f5694<0xa;_0x1f5694++){let _0x1f8288=Math['round'](random()),_0x55b77c=_0x1f8288?random(this['spawnX']+this['followRange']/1.9,this['spawnX']+this['followRange']):random(this['spawnX']-this['followRange'],this['spawnX']-this['followRange']/1.9),_0x20d364=this['y'];if(this['gameRef']['physics']['solidExistsInArea'](_0x55b77c,_0x20d364+this['height']-0x1,this['width']-0x1,0x1869f,[this])){this['setWaypoint'](_0x55b77c,_0x20d364);break;}}}['goToWaypoint'](){if(!this['waypoint'])return;let _0x1c1733=dist(this['waypoint']['x'],this['waypoint']['y'],this['x'],this['y']);if(_0x1c1733<this['attackRange']){this['waypoint']=null;return;}else{if(performance['now']()-this['targetLastSeen']>this['targetForgetTime'])this['waypoint']=null;else{if(Math['abs'](this['waypoint']['x']-this['x'])>this['attackRange']){if(this['waypoint']['x']>this['x']){this['walkRight']();if(this['mayFall']&&this['fallDirection']=='right')this['jump']();}else{if(this['waypoint']['x']<this['x']){this['walkLeft']();if(this['mayFall']&&this['fallDirection']=='left')this['jump']();}}}}}}['attackNearbyEnemies'](){let _0x38b62e=this['getPlayersWithinRange'](this['attackRange']);_0x38b62e['length']&&this['attack']();}['onAttackStart'](){super['onAttackStart'](),setTimeout(function(){let _0x137db1=this['getPlayersWithinRange'](this['attackRange']);_0x137db1['forEach'](_0x499cd5=>_0x499cd5['obj']['inflictDamage'](this,Math['floor'](random(this['attackDamageMin'],this['attackDamageMax'])))),this['resources']['sounds']['attack']['volume'](0.3),this['resources']['sounds']['attack']['rate'](random(0.8,1.1)),this['resources']['sounds']['attack']['play']();}['bind'](this),0x3e8/this['attackSpeed']);}['onSpawn'](){super['onSpawn'](),this['waypoint']=null;}['onDeath'](_0x5cf874){super['onDeath'](_0x5cf874),setTimeout(()=>{this['visible']=0x0;},0x3e8),_0x5cf874==this['gameRef']['player']&&_0x5cf874['giveXP'](0xa+Math['floor'](this['spawnX']/0xa)),this==this['gameRef']['finalBoss']&&setTimeout(()=>{this['gameRef']['endGame']();},0x3e8);}['onWallBump'](_0x43659a){super['onWallBump'](),!_0x43659a['some'](_0xe91713=>_0xe91713['type']=='Knight')&&(performance['now']()-this['lastJump']>this['jumpDelayMs']&&(this['lastJump']=performance['now'](),this['jump']()));}['setWaypoint'](_0x5880f1,_0x1c9e22){this['waypoint']={'x':_0x5880f1,'y':_0x1c9e22},this['targetLastSeen']=performance['now']();}['getPlayersWithinRange'](_0x5d361c){let _0x3774e=this['gameRef']['objects']['filter'](_0x5d6c5=>_0x5d6c5?.['type']=='Knight'&&!_0x5d6c5?.['isCloaked']&&!_0x5d6c5['dead'])['map'](_0x1a8f07=>{return{'obj':_0x1a8f07,'distance':dist(_0x1a8f07['x']+_0x1a8f07['width']/0x2,_0x1a8f07['y']+_0x1a8f07['height']/0x2,this['x']+this['width']/0x2,this['y']+this['height']/0x2)/this['gameRef']['graphics']['scaleRatio']};})['filter'](_0x5387ab=>_0x5387ab['distance']<=_0x5d361c);return _0x3774e['length']?(_0x3774e['sort']((_0xcf8df8,_0x32497e)=>_0x32497e['distance']-_0xcf8df8['distance']),_0x3774e):[];}}var myGame,draggedObj=null,ctrlReleased=!![],delReleased=!![];function setup(){myGame=new CustomGame(2.5),myGame['sky']([0xa8,0xc0,0x10d]),fetch(myGame['resources']['customMap'])['then'](_0x59f4d8=>_0x59f4d8['json']())['then'](_0x589e4f=>{setupMap(_0x589e4f),console['log']('Loaded\x20map\x20from\x20'+myGame['resources']['customMap']);let _0x3c21e3=myGame['objects']['filter'](_0x1a4a03=>_0x1a4a03['type']=='Skeleton');_0x3c21e3['forEach'](_0x2ef483=>{_0x2ef483['maxHP']+=Math['floor'](_0x2ef483['x']/0x19),_0x2ef483['currentHP']+=Math['floor'](_0x2ef483['x']/0x19),_0x2ef483['attackDamageMin']+=Math['floor'](_0x2ef483['x']/0x1f4),_0x2ef483['attackDamageMax']+=Math['floor'](_0x2ef483['x']/0x1f4);}),_0x3c21e3[_0x3c21e3['length']-0x1]['width']*=1.5,_0x3c21e3[_0x3c21e3['length']-0x1]['height']*=1.5,_0x3c21e3[_0x3c21e3['length']-0x1]['maxHP']+=0x7d0,_0x3c21e3[_0x3c21e3['length']-0x1]['currentHP']+=0x7d0,_0x3c21e3[_0x3c21e3['length']-0x1]['speed']*=0.5,myGame['finalBoss']=_0x3c21e3[_0x3c21e3['length']-0x1],myGame['character'](Knight,0x32,0xb4),myGame['player']['levelupFX']=myGame['tile'](LevelupFX,0x32,0x8c);})['catch'](_0x4101b8=>{console['error']('Error\x20loading\x20map!\x20',_0x4101b8);});}function setupMap(_0x1e0188){_0x1e0188['forEach'](_0x1648ff=>{switch(_0x1648ff['type']){case'Cloud':myGame['tile'](Cloud,_0x1648ff['x'],_0x1648ff['y']);break;case'Mountain':myGame['tile'](Mountain,_0x1648ff['x'],_0x1648ff['y']);break;case'Tree':myGame['tile'](Tree,_0x1648ff['x'],_0x1648ff['y']);break;default:break;}}),_0x1e0188['forEach'](_0x52ff2a=>{switch(_0x52ff2a['type']){case'Ground':myGame['tile'](Ground,_0x52ff2a['x'],_0x52ff2a['y']);break;case'CanyonLeft':myGame['tile'](CanyonLeft,_0x52ff2a['x'],_0x52ff2a['y']);break;case'CanyonRight':myGame['tile'](CanyonRight,_0x52ff2a['x'],_0x52ff2a['y']);break;case'Box':myGame['tile'](Box,_0x52ff2a['x'],_0x52ff2a['y']);break;case'Stone':myGame['tile'](Stone,_0x52ff2a['x'],_0x52ff2a['y']);break;case'Checkpoint':myGame['tile'](Checkpoint,_0x52ff2a['x'],_0x52ff2a['y']);break;default:break;}}),_0x1e0188['forEach'](_0x228c22=>{switch(_0x228c22['type']){case'Coin':myGame['tile'](Coin,_0x228c22['x'],_0x228c22['y']);break;default:break;}}),_0x1e0188['forEach'](_0x24729b=>{switch(_0x24729b['type']){case'Skeleton':myGame['tile'](Skeleton,_0x24729b['x'],_0x24729b['y']);break;default:break;}});}function mapEditor(){let _0x35c249=mouseX-myGame['graphics']['cameraX']*2.5,_0x1697e8=mouseY-myGame['graphics']['cameraY']*2.5;textSize(0x10),stroke('black'),strokeWeight(0x3),fill('white');let _0x51a44f=myGame['physics']['getSolidsInArea'](_0x35c249/2.5,_0x1697e8/2.5,0x1,0x1);if(_0x51a44f['length']){let _0x5c0332=myGame['objects']['findIndex'](_0x550382=>_0x550382==_0x51a44f[0x0]);text(_0x5c0332,mouseX,mouseY);}if(mouseIsPressed){if(draggedObj){fill('white'),text(_0x35c249+'-'+_0x1697e8,mouseX,mouseY),noStroke(),fill([0x0,0xff,0x0,0x64]),rect((draggedObj['x']+myGame['graphics']['cameraX'])*2.5,(draggedObj['y']+myGame['graphics']['cameraY'])*2.5,draggedObj['width']*2.5,draggedObj['height']*2.5);let _0x8aafe6=myGame['objects']['map'](_0x186650=>{return{'obj':_0x186650,'distance':dist(_0x186650['x']+_0x186650['width']/0x2,_0x186650['y']+_0x186650['height']/0x2,_0x35c249/2.5,_0x1697e8/2.5)/myGame['graphics']['scaleRatio']};})['filter'](_0x328d02=>_0x328d02['distance']<0x8&&_0x328d02['obj']['solid']&&_0x328d02['obj']!=draggedObj);if(_0x8aafe6['length']&&keyIsDown(0x12)){let _0x456823=_0x8aafe6['sort']((_0x1431ff,_0x445c9c)=>_0x1431ff['distance']-_0x445c9c['distance'])[0x0]['obj'];draggedObj['x']=_0x35c249/2.5-draggedObj['width']/0x2,draggedObj['y']=_0x456823['y'],draggedObj['spawnX']=draggedObj['x'],draggedObj['spawnY']=draggedObj['y'];}else draggedObj['x']=_0x35c249/2.5-draggedObj['width']/0x2,draggedObj['y']=_0x1697e8/2.5-draggedObj['height']/0x2,draggedObj['spawnX']=draggedObj['x'],draggedObj['spawnY']=draggedObj['y'];}else{let _0x5df279=myGame['physics']['getSolidsInArea'](_0x35c249/2.5,_0x1697e8/2.5,0x1,0x1);if(!_0x5df279['length'])return;draggedObj=_0x5df279[0x0];}}else draggedObj=null;if(keyIsDown(0x11)&&ctrlReleased){ctrlReleased=![];let _0xb602b8=myGame['physics']['getSolidsInArea'](_0x35c249/2.5,_0x1697e8/2.5,0x1,0x1);if(_0xb602b8['length']){let _0x5be478=_0xb602b8[0x0];if(_0x5be478 instanceof Stone)myGame['tile'](Ground,_0x5be478['x'],_0x5be478['y']),myGame['remove'](_0x5be478);else{if(_0x5be478 instanceof Ground)myGame['tile'](CanyonLeft,_0x5be478['x'],_0x5be478['y']),myGame['remove'](_0x5be478);else{if(_0x5be478 instanceof CanyonLeft)myGame['tile'](CanyonRight,_0x5be478['x'],_0x5be478['y']),myGame['remove'](_0x5be478);else{if(_0x5be478 instanceof CanyonRight)myGame['tile'](Box,_0x5be478['x'],_0x5be478['y']),myGame['remove'](_0x5be478);else _0x5be478 instanceof Box&&(myGame['tile'](Stone,_0x5be478['x'],_0x5be478['y']),myGame['remove'](_0x5be478));}}}}else myGame['tile'](Stone,_0x35c249/2.5-0x8,_0x1697e8/2.5-0x8);}if(keyIsDown(0x2e)&&delReleased){delReleased=![];let _0xc86860=myGame['physics']['getSolidsInArea'](_0x35c249/2.5,_0x1697e8/2.5,0x1,0x1);if(_0xc86860['length'])myGame['remove'](_0xc86860[0x0]);}if(!keyIsDown(0x11))ctrlReleased=!![];if(!keyIsDown(0x2e))delReleased=!![];}function draw(){myGame['run']();}